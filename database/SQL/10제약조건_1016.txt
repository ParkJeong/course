/*
열레벨 제약조건(PK, FK, NOT NULL, CHECK, UNIQUE)
1. PK - 테이블 고유 식별 칼럼(NOT NULL + UNIQUE)
PRIMARY KEY
2. UNIQUE = 유일한 값을 갖게하는 칼럼(중복데이터의 방지)
3. NOT NULL - NULL을 허용하지 않는다.
4. FK - 참조하는 테이블의 PK를 저장하는 칼럼
FOREIGN KEY
5. CHECK - 정의된 형식만 들어오도록 허용

*/

FOREIGN KEY
테이블 간의 관계를 설정한다.

CHECK

COL VARCHAR2(1) CHECK (COL IN ('A', 'B', 'C'))

CHECK (COL < 10)
CHECK (COL = 'ABCDE')
CHECK (COL BETWEEN 5 AND 6)
CHECK (COL LIKE '_A' OR LIKE 'A%')



제약 조건의 추가 또는 삭제는 가능하다. 그러나 수정은 불가능하다.
제약조건의 활성화 또는 비활성화는 가능하다.
MODIFY절을 사용하여 NOT NULL 조건을 추가할 수 있다.

제약조건 추가
ALTER TABLE table_name
ADD CONSTRAINT constraint_name type (column);


제약조건 삭제
ALTER TABLE table_name
DROP PRIMARY KEY
    | UNIQUE (column)
    | CONSTRAINT consraint_name
[CASCADE];



--PK 추가
ALTER TABLE DEPT2
ADD CONSTRAINT DEPT2_DEPT_NO_PK PRIMARY KEY(DEPT_NO);

-- FK 추가
ALTER TABLE DEPT2
ADD CONSTRAINT DEPT2_LOCA_LOCATIONS_LOCATION_ID_FK FOREIGN KEY (LOCA) REFERENCES LOCATIONS(LOCATION_ID);

--CHECK추가
ALTER TABLE DEPT2
ADD CONSTRAINT DEPT2_DEPT_GENDER_CK CHECK (DEPT_GENDER IN ('F', 'M'));

--UNIQUE추가
ALTER TABLE DEPT2
ADD CONSTRAINT DEPT2_DEPT_NAME_UK UNIQUE (DEPT_NAME);

--NOT NULL은 열 수정형태로 변경한다.
ALTER TABLE DEPT2
MODIFY DEPT_NAME VARCHAR(14) NOT NULL;


DESC DEPT2;
--제약조건 삭제 (제약조건 이름으로)
ALTER TABLE DEPT2
DROP CONSTRAINT DEPT2_DEPT_NO;

--FK는 부모테이블에 값이 없다면 삽입이 불가능
INSERT INTO DEPT2
VALUES (10, 'TEST', 100, SYSDATE, 5000, 'F');--에러남 LOCATIONS의 LOCATION_ID에는 100이라는 값이 없기 때문이다.



CREATE TABLE MEMBERS(
    M_NAME VARCHAR2(10) NOT NULL,
    M_NUM NUMBER(3)     CONSTRAINT MEM_MEMNUM_PK PRIMARY KEY,
    REG_DATE DATE       NOT NULL CONSTRAINT MEME_REGDATE_UK UNIQUE,
    GENDER VARCHAR2(1),
    LOCA NUMBER(4)      CONSTRAINT MEM_LOCA_LOC_LOCID_FK 
                        REFERENCES LOCATIONS(LOCATION_ID)
);


CREATE TABLE MEMBERS(
    M_NAME VARCHAR2(10) NOT NULL,
    MN_NUM NUMBER(3),
    REG_DATE DATE,
    GENDER VARCHAR2(1),
    LOCA NUMBER(4),
    CONSTRAINT MEM_MEMNUM_PK PRIMARY KEY (M_NAME),
    CONSTRAINT MEM_REGDATE_UK UNIQUE (REG_DATE),
    CONSTRAINT MEM_LOCA_LOC_LOCID_FK FOREIGN KEY (LOCA)
        REFERENCES LOCATIONS(LOCATION_ID)
);



CREATE TABLE MEMBERS(
    M_NAME VARCHAR2(10),
    M_NUM NUMBER(2),
    REG_DATE DATE,
    GENDER VARCHAR2(2),
    LOCA NUMBER(4)
);

ALTER TABLE MEMBERS
MODIFY M_NAME VARCHAR2(10) NOT NULL;

ALTER TABLE MEMBERS
ADD CONSTRAINT MEM_MEMNUM_PK PRIMARY KEY (M_NUM);

ALTER TABLE MEMBERS
ADD CONSTRAINT MEM_REGDATE_UK UNIQUE (REG_DATE);

ALTER TABLE MEMBERS
ADD CONSTRAINT MEM_LOCA_LOC_LOCID_FK FOREIGN KEY (LOCA) REFERENCES LOCATIONS(LOCATION_ID);

ALTER TABLE MEMBERS
MODIFY REG_DATE DATE DEFAULT SYSDATE;



